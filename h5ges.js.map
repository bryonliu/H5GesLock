{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"h5ges.js","sourcesContent":["/**\r\n * Created by bryonliu on 2016/8/15.\r\n */\r\n/*\r\n *类型 ： 输入密码\r\n *    ：  设置密码\r\n *\r\n * option={\r\n *   width {int}\r\n *   height {int},\r\n *   type {int} 3*3,4*4,5*5\r\n *   inputEnd {function}\r\n *  }\r\n * */\r\n\r\nclass H5Ges {\r\n\r\n    constructor(options) {\r\n        this.options = options || {};\r\n        this.width = options.width || document.body.offsetWidth;\r\n        this.height = options.height || 320;\r\n        this.R = options.R || 25;\r\n        this.dy = options.type || 3; // 维度 默认是3*3\r\n        this.offsetX = 40; //触摸点上下和左右的留白\r\n        this.offsetY = 40;\r\n        this.touchSpots = caculateTouchSpotsLocation(this);\r\n        if (!options.container || !document.getElementById(options.container)) {\r\n            throw new Error(\"please input right id of you canvas\");\r\n        }\r\n        this.mContainer = document.getElementById(options.container);\r\n        this.mContext = this.mContainer.getContext(\"2d\");\r\n\r\n        this.mContainer.width = this.width;\r\n        this.mContainer.height = this.height;\r\n        this.default_color = \"#C3E0C4\"; // 默认绘图颜色值\r\n        this.default_color_warn = \"#C95B5A\";//默认警告颜色值\r\n        this.inputEnd = options.inputEnd;\r\n\r\n        this.touchStartListener = touchStartHandler(this);\r\n        this.touchMoveListenner = touchMoveHandler(this);\r\n        this.touchEndListener = touchEndHandler(this);\r\n    }\r\n\r\n    init() {\r\n        this.clear();\r\n        this.hasTouchedSpots=[];\r\n        drawTouchSpots(this);\r\n        bindEvent(this);\r\n    }\r\n\r\n    clear() {\r\n        this.mContext.clearRect(0, 0, this.width, this.height);\r\n    }\r\n\r\n    drawWarn() {\r\n        this.clear();\r\n        drawWarn(this, this.lastTouchSpots);\r\n    }\r\n}\r\nwindow.H5Ges = H5Ges;\r\n/**\r\n * 计算手势密码的N*N个位置\r\n * 3*3顺序依次为：\r\n *    1 2 3\r\n *    4 5 6\r\n *    7 8 9\r\n */\r\nfunction caculateTouchSpotsLocation(H5Ges) {\r\n    var spots = [];\r\n\r\n    let X_Dis = (H5Ges.width - 2 * H5Ges.offsetX - 2 * H5Ges.R) / (H5Ges.dy - 1); // X 轴上的圆心距\r\n    let Y_Dis = (H5Ges.height - 2 * H5Ges.offsetY - 2 * H5Ges.R) / (H5Ges.dy - 1); // Y 轴上的圆心距\r\n\r\n    for (let row = 0; row < H5Ges.dy; row++) {\r\n        for (let col = 0; col < H5Ges.dy; col++) {\r\n            let point = {\r\n                X: H5Ges.offsetX + H5Ges.R + col * X_Dis,\r\n                Y: H5Ges.offsetY + H5Ges.R + row * Y_Dis\r\n            }\r\n            console.log(\"X = \" + point.X + \" Y = \" + point.Y);\r\n            spots.push(point);\r\n        }\r\n    }\r\n    return spots;\r\n}\r\n\r\nfunction draw(h5ges, touchSpots, color, lastPoint) {\r\n    dranTouchLine(h5ges.mContext, touchSpots, color, lastPoint, h5ges.touchSpots);\r\n    drawTouchSpots(h5ges);\r\n}\r\nfunction drawNormal(h5ges, touchSpots, lastPoint) {\r\n    draw(h5ges, touchSpots, h5ges.default_color, lastPoint);\r\n}\r\nfunction drawWarn(h5ges, touchSpots) {\r\n    draw(h5ges, touchSpots, h5ges.default_color_warn, null, h5ges.touchSpots);\r\n}\r\nfunction drawTouchSpots(h5ges) {\r\n\r\n    var mContext = h5ges.mContext;\r\n\r\n    h5ges.touchSpots.forEach(function (spot) {\r\n        mContext.beginPath();\r\n        mContext.lineWidth = 2;\r\n        mContext.strokeStyle = h5ges.default_color;\r\n        mContext.arc(spot.X, spot.Y, h5ges.R, 0, Math.PI * 2);\r\n        mContext.closePath();\r\n        mContext.stroke();\r\n    });\r\n}\r\n\r\nfunction drawTouchCenter(mContext, touchSpots, color, allSpots) {\r\n    touchSpots.forEach(function (spotIndex) {\r\n        var spot = allSpots[spotIndex];\r\n        mContext.beginPath();\r\n        mContext.lineWidth = 1;\r\n        mContext.fillStyle = color;\r\n        mContext.arc(spot.X, spot.Y, 10, 0, Math.PI * 2);\r\n        mContext.fill();\r\n        mContext.closePath();\r\n        mContext.stroke();\r\n    });\r\n}\r\nfunction dranTouchLine(mContext, touchSpots, color, lastPoint, allSpots) {\r\n\r\n    if (!touchSpots || touchSpots.length == 0) return;\r\n    mContext.beginPath();\r\n    touchSpots.forEach(function (spot) {\r\n        mContext.lineTo(allSpots[spot].X, allSpots[spot].Y);\r\n    });\r\n    mContext.lineWidth = 6;\r\n    mContext.strokeStyle = color;\r\n    mContext.stroke();\r\n    mContext.closePath();\r\n\r\n    if (lastPoint != null) {\r\n        let lastTouchSpotIndex = touchSpots[touchSpots.length - 1];\r\n        let lastSpot = allSpots[lastTouchSpotIndex];\r\n        mContext.beginPath();\r\n        mContext.moveTo(lastSpot.X, lastSpot.Y);\r\n        mContext.lineTo(lastPoint.X, lastPoint.Y);\r\n        mContext.stroke();\r\n        mContext.closePath();\r\n    }\r\n    drawTouchCenter(mContext, touchSpots, color, allSpots);\r\n}\r\nfunction bindEvent(h5Ges) {\r\n\r\n    h5Ges.mContainer.addEventListener(\"touchstart\",h5Ges.touchStartListener, false);\r\n    h5Ges.mContainer.addEventListener(\"touchmove\",h5Ges.touchMoveListenner, false);\r\n    h5Ges.mContainer.addEventListener(\"touchend\",h5Ges.touchEndListener, false);\r\n}\r\nvar touchStartHandler = function(h5Ges){\r\n    return function (e) {\r\n        let touche = e.touches[0];\r\n        isTouchSpot({X: touche.pageX, Y: touche.pageY}, h5Ges.hasTouchedSpots, h5Ges.touchSpots, h5Ges.R);\r\n    };\r\n}\r\n\r\nvar touchMoveHandler = function(h5Ges){\r\n    return function (e) {\r\n        e.preventDefault();\r\n        var touche = e.touches[0];\r\n        var istouch = isTouchSpot({X: touche.pageX, Y: touche.pageY}, h5Ges.hasTouchedSpots, h5Ges.touchSpots, h5Ges.R);\r\n        pickSpotsOnLine(h5Ges.hasTouchedSpots,h5Ges.dy);\r\n        h5Ges.clear();\r\n        let lastPoint = istouch ? null : {X: touche.pageX, Y: touche.pageY};\r\n        drawNormal(h5Ges, h5Ges.hasTouchedSpots, lastPoint);\r\n    };\r\n}\r\nvar touchEndHandler = function(h5Ges){\r\n    return function (e) {\r\n        h5Ges.clear();\r\n        drawNormal(h5Ges, h5Ges.hasTouchedSpots);\r\n        h5Ges.lastTouchSpots = h5Ges.hasTouchedSpots;\r\n\r\n        if (h5Ges.inputEnd && typeof h5Ges.inputEnd == \"function\") {\r\n            h5Ges.inputEnd(h5Ges.hasTouchedSpots.join(\"\"));\r\n        } else {\r\n            console.log(h5Ges.hasTouchedSpots.join(\"\"));\r\n        }\r\n        h5Ges.hasTouchedSpots = [];\r\n        unbindEvent(h5Ges);\r\n    };\r\n}\r\n\r\nfunction unbindEvent(h5Ges){\r\n    var mContainer = h5Ges.mContainer;\r\n    mContainer.removeEventListener(\"touchstart\",h5Ges.touchStartListener, false);\r\n    mContainer.removeEventListener(\"touchmove\",h5Ges.touchMoveListenner, false);\r\n    mContainer.removeEventListener(\"touchend\",h5Ges.touchEndListener, false);\r\n}\r\n/**\r\n * 判断是否触摸到某个点以及是否已经被触摸过\r\n */\r\nfunction isTouchSpot(currentSpot, touchedSpots, allSpots, R) {\r\n    return allSpots.some(function (spot, index) {\r\n        let xDiff = spot.X - currentSpot.X;\r\n        let yDiff = spot.Y - currentSpot.Y;\r\n        var dir = Math.pow((xDiff * xDiff + yDiff * yDiff), 0.5);\r\n        if (dir < R & touchedSpots.indexOf(index) < 0) {\r\n            touchedSpots.push(index);\r\n            return true;\r\n        }\r\n    });\r\n}\r\n/**\r\n * 检查任意相邻两点直接是否有其他点，如果有者插入他们中间\r\n * @param touchedSpots\r\n * @param d\r\n */\r\nfunction pickSpotsOnLine(touchedSpots,d){\r\n    //var result = touchedSpots.slice(0);\r\n\r\n    for(let i = 0 ;i < touchedSpots.length - 1;i++){\r\n\r\n       var nums = numberOntheLineOf(touchedSpots[i],touchedSpots[i+1],d)\r\n        var last = i+1;\r\n       for(let k = 0;k <nums.length;k++){\r\n           if(touchedSpots.indexOf(nums[k])==-1){\r\n               console.log(\"has\")\r\n              touchedSpots.splice(last,0,nums[k]);\r\n               last+=1;\r\n           }\r\n       }\r\n    }\r\n}\r\n/***\r\n * @brify 判断两个相连的数字在d*d宫格中的连线上是否有其他数字， 比如在九宫格中，0，2之间会有1\r\n * @param i 数字i\r\n * @param j 数字j\r\n * @param d 维度d(3*3,4*4)\r\n * @returns {Array}\r\n */\r\nfunction numberOntheLineOf(i, j, d) {\r\n    var result = [];\r\n    if (i > j) {\r\n        var t = i;\r\n        i = j;\r\n        j = t;\r\n    }\r\n    var ix = i % d, iy = parseInt(i / d);\r\n    var jx = j % d, jy = parseInt(j / d);\r\n\r\n\r\n    var dx = jx - ix, dy = jy - iy;\r\n\r\n    if (dx != dy && dx != 0 && dy != 0) return result;\r\n\r\n    //console.log(\"dx : dy = \" + dx + \" : \" + dy);\r\n    if (dx == dy) {\r\n        var begin = d + 1 + i;\r\n        while (begin < j) {\r\n            result.push(begin);\r\n            console.log(begin);\r\n            begin += (d + 1);\r\n        }\r\n    } else if (dx == 0) {\r\n        var begin = i + d;\r\n        while (begin < j) {\r\n            result.push(begin);\r\n            begin += d;\r\n        }\r\n\r\n    } else if (dy == 0) {\r\n\r\n        var begin = i + 1;\r\n\r\n        while (begin < j) {\r\n            result.push(begin);\r\n            begin += 1;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n"]}